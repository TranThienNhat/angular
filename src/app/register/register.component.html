<!-- Main Container -->
<div class="register-container">
  <div class="register-card">
    <!-- Header Section -->
    <div class="register-header">
      <i class="fas fa-user-plus"></i>
      <h2>Đăng Ký Tài Khoản</h2>
      <p>Vui lòng điền đầy đủ thông tin bên dưới</p>
    </div>

    <!-- Alert Messages -->
    <div
      *ngIf="successMessage"
      class="alert alert-success alert-dismissible fade show"
      role="alert"
    >
      <i class="fas fa-check-circle"></i>
      {{ successMessage }}
      <button
        type="button"
        class="btn-close"
        (click)="successMessage = ''"
        aria-label="Close"
      ></button>
    </div>

    <div
      *ngIf="errorMessage"
      class="alert alert-danger alert-dismissible fade show"
      role="alert"
    >
      <i class="fas fa-exclamation-circle"></i>
      {{ errorMessage }}
      <button
        type="button"
        class="btn-close"
        (click)="errorMessage = ''"
        aria-label="Close"
      ></button>
    </div>

    <!-- Registration Form -->
    <form
      [formGroup]="registerForm"
      (ngSubmit)="onSubmit()"
      class="needs-validation"
      novalidate
    >
      <!-- Account Information Section -->
      <div class="form-section">
        <h3 class="section-title">
          <i class="fas fa-lock"></i>
          Thông Tin Tài Khoản
        </h3>
        <div class="form-group">
          <label for="username">
            <i class="fas fa-user"></i>
            Tên Đăng Nhập <span class="required">*</span>
          </label>
          <input
            type="text"
            id="username"
            formControlName="username"
            class="form-control"
            [ngClass]="{
              'is-invalid': isFieldInvalid('username'),
              'is-valid': isFieldValid('username')
            }"
            placeholder="Nhập tên đăng nhập"
          />
          <div *ngIf="isFieldInvalid('username')" class="validation-message">
            <i class="fas fa-exclamation-circle"></i>
            {{ getErrorMessage("username") }}
          </div>
        </div>

        <div class="form-group">
          <label for="email">
            <i class="fas fa-envelope"></i>
            Email <span class="required">*</span>
          </label>
          <input
            type="email"
            id="email"
            formControlName="email"
            class="form-control"
            [ngClass]="{
              'is-invalid': isFieldInvalid('email'),
              'is-valid': isFieldValid('email')
            }"
            placeholder="Nhập email của bạn"
          />
          <div *ngIf="isFieldInvalid('email')" class="validation-message">
            <i class="fas fa-exclamation-circle"></i>
            {{ getErrorMessage("email") }}
          </div>
        </div>

        <div class="form-group">
          <label for="password">
            <i class="fas fa-key"></i>
            Mật Khẩu <span class="required">*</span>
          </label>
          <div class="password-input-group">
            <input
              [type]="showPassword ? 'text' : 'password'"
              id="password"
              formControlName="password"
              class="form-control"
              [ngClass]="{
                'is-invalid': isFieldInvalid('password'),
                'is-valid': isFieldValid('password')
              }"
              placeholder="Nhập mật khẩu"
            />
            <button
              type="button"
              class="password-toggle"
              (click)="togglePasswordVisibility()"
            >
              <i
                class="fas"
                [ngClass]="showPassword ? 'fa-eye-slash' : 'fa-eye'"
              ></i>
            </button>
          </div>
          <div *ngIf="isFieldInvalid('password')" class="validation-message">
            <i class="fas fa-exclamation-circle"></i>
            {{ getErrorMessage("password") }}
          </div>
        </div>

        <div class="form-group">
          <label for="confirmPassword">
            <i class="fas fa-key"></i>
            Xác Nhận Mật Khẩu <span class="required">*</span>
          </label>
          <div class="password-input-group">
            <input
              [type]="showConfirmPassword ? 'text' : 'password'"
              id="confirmPassword"
              formControlName="confirmPassword"
              class="form-control"
              [ngClass]="{
                'is-invalid': isFieldInvalid('confirmPassword'),
                'is-valid': isFieldValid('confirmPassword')
              }"
              placeholder="Nhập lại mật khẩu"
            />
            <button
              type="button"
              class="password-toggle"
              (click)="toggleConfirmPasswordVisibility()"
            >
              <i
                class="fas"
                [ngClass]="showConfirmPassword ? 'fa-eye-slash' : 'fa-eye'"
              ></i>
            </button>
          </div>
          <div
            *ngIf="isFieldInvalid('confirmPassword')"
            class="validation-message"
          >
            <i class="fas fa-exclamation-circle"></i>
            {{ getErrorMessage("confirmPassword") }}
          </div>
        </div>
      </div>

      <!-- Personal Information Section -->
      <div class="form-section">
        <h3 class="section-title">
          <i class="fas fa-user"></i>
          Thông Tin Cá Nhân
        </h3>
        <div class="form-group">
          <label for="name">
            <i class="fas fa-user"></i>
            Họ và Tên <span class="required">*</span>
          </label>
          <input
            type="text"
            id="name"
            formControlName="name"
            class="form-control"
            [ngClass]="{
              'is-invalid': isFieldInvalid('name'),
              'is-valid': isFieldValid('name')
            }"
            placeholder="Nhập họ và tên của bạn"
          />
          <div *ngIf="isFieldInvalid('name')" class="validation-message">
            <i class="fas fa-exclamation-circle"></i>
            {{ getErrorMessage("name") }}
          </div>
        </div>
      </div>

      <!-- Contact Information Section -->
      <div class="form-section">
        <h3 class="section-title">
          <i class="fas fa-address-book"></i>
          Thông Tin Liên Hệ
        </h3>
        <div class="form-group">
          <label for="phoneNumber">
            <i class="fas fa-phone"></i>
            Số Điện Thoại <span class="required">*</span>
          </label>
          <input
            type="tel"
            id="phoneNumber"
            formControlName="phoneNumber"
            class="form-control"
            [ngClass]="{
              'is-invalid': isFieldInvalid('phoneNumber'),
              'is-valid': isFieldValid('phoneNumber')
            }"
            placeholder="Nhập số điện thoại"
          />
          <div *ngIf="isFieldInvalid('phoneNumber')" class="validation-message">
            <i class="fas fa-exclamation-circle"></i>
            {{ getErrorMessage("phoneNumber") }}
          </div>
        </div>

        <div class="form-group">
          <label for="address">
            <i class="fas fa-map-marker-alt"></i>
            Địa Chỉ <span class="required">*</span>
          </label>
          <textarea
            id="address"
            formControlName="address"
            class="form-control"
            [ngClass]="{
              'is-invalid': isFieldInvalid('address'),
              'is-valid': isFieldValid('address')
            }"
            rows="3"
            placeholder="Nhập địa chỉ của bạn"
          ></textarea>
          <div *ngIf="isFieldInvalid('address')" class="validation-message">
            <i class="fas fa-exclamation-circle"></i>
            {{ getErrorMessage("address") }}
          </div>
        </div>
      </div>

      <!-- Submit Button -->
      <div class="form-group submit-group">
        <button
          type="submit"
          class="btn btn-primary submit-btn"
          [disabled]="isSubmitting"
        >
          <i class="fas" [ngClass]="isSubmitting ? 'fa-spinner fa-spin' : 'fa-user-plus'"></i>
          {{ isSubmitting ? "Đang xử lý..." : "Đăng Ký" }}
        </button>
      </div>

      <!-- Login Link -->
      <div class="login-link">
        <p>
          Đã có tài khoản?
          <a routerLink="/user/login">Đăng nhập ngay</a>
        </p>
      </div>
    </form>
  </div>
</div>
