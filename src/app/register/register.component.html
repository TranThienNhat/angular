<!-- Main Container -->
<div class="register-container" @fadeInDown>
  <div class="register-card">
    <!-- Header Section -->
    <div class="register-header">
      <i class="bi bi-person-plus-fill"></i>
      <h2>Đăng ký tài khoản</h2>
      <p class="text-muted">Vui lòng điền thông tin để tạo tài khoản mới</p>
    </div>

    <!-- Alert Messages -->
    <div class="alert-container">
      <div *ngIf="successMessage" class="alert alert-success" role="alert">
        <i class="bi bi-check-circle-fill"></i>
        <span>{{ successMessage }}</span>
        <button
          type="button"
          class="btn-close"
          (click)="successMessage = ''"
          aria-label="Close"
        ></button>
      </div>

      <div *ngIf="errorMessage" class="alert alert-danger" role="alert">
        <i class="bi bi-exclamation-triangle-fill"></i>
        <span>{{ errorMessage }}</span>
        <button
          type="button"
          class="btn-close"
          (click)="errorMessage = ''"
          aria-label="Close"
        ></button>
      </div>
    </div>

    <!-- Registration Form -->
    <form
      [formGroup]="registerForm"
      (ngSubmit)="onSubmit()"
      class="register-form"
      novalidate
    >
      <!-- Personal Information Section -->
      <div class="form-section">
        <h3 class="section-title">Thông tin cá nhân</h3>

        <div class="form-row">
          <!-- Username -->
          <div class="form-group">
            <label for="username">
              <i class="bi bi-person"></i>
              Tên đăng nhập <span class="required">*</span>
            </label>
            <input
              type="text"
              id="username"
              formControlName="username"
              placeholder="Nhập tên đăng nhập"
              [disabled]="isLoading"
              [class.is-invalid]="username?.invalid && username?.touched"
              [class.is-valid]="username?.valid && username?.touched"
            />
            <div
              class="validation-message"
              *ngIf="username?.invalid && username?.touched"
            >
              <span *ngIf="username?.errors?.['required']"
                >Tên đăng nhập là bắt buộc</span
              >
              <span *ngIf="username?.errors?.['minlength']"
                >Tên đăng nhập phải có ít nhất 3 ký tự</span
              >
            </div>
          </div>

          <!-- Password -->
          <div class="form-group">
            <label for="password">
              <i class="bi bi-lock"></i>
              Mật khẩu <span class="required">*</span>
            </label>
            <div class="password-input">
              <input
                [type]="showPassword ? 'text' : 'password'"
                id="password"
                formControlName="password"
                placeholder="Nhập mật khẩu"
                [disabled]="isLoading"
                [class.is-invalid]="password?.invalid && password?.touched"
                [class.is-valid]="password?.valid && password?.touched"
              />
              <button
                type="button"
                class="toggle-password"
                (click)="togglePasswordVisibility()"
                [disabled]="isLoading"
              >
                <i [class]="showPassword ? 'bi bi-eye-slash' : 'bi bi-eye'"></i>
              </button>
            </div>
            <div
              class="validation-message"
              *ngIf="password?.invalid && password?.touched"
            >
              <span *ngIf="password?.errors?.['required']"
                >Mật khẩu là bắt buộc</span
              >
              <span *ngIf="password?.errors?.['minlength']"
                >Mật khẩu phải có ít nhất 6 ký tự</span
              >
            </div>
          </div>
        </div>

        <!-- Email -->
        <div class="form-group">
          <label for="email">
            <i class="bi bi-envelope"></i>
            Email <span class="required">*</span>
          </label>
          <input
            type="email"
            id="email"
            formControlName="email"
            placeholder="Nhập địa chỉ email"
            [disabled]="isLoading"
            [class.is-invalid]="email?.invalid && email?.touched"
            [class.is-valid]="email?.valid && email?.touched"
          />
          <div
            class="validation-message"
            *ngIf="email?.invalid && email?.touched"
          >
            <span *ngIf="email?.errors?.['required']">Email là bắt buộc</span>
            <span *ngIf="email?.errors?.['email']">Email không hợp lệ</span>
          </div>
        </div>

        <!-- Full Name -->
        <div class="form-group">
          <label for="name">
            <i class="bi bi-person-badge"></i>
            Họ và tên <span class="required">*</span>
          </label>
          <input
            type="text"
            id="name"
            formControlName="name"
            placeholder="Nhập họ và tên"
            [disabled]="isLoading"
            [class.is-invalid]="name?.invalid && name?.touched"
            [class.is-valid]="name?.valid && name?.touched"
          />
          <div
            class="validation-message"
            *ngIf="name?.invalid && name?.touched"
          >
            <span *ngIf="name?.errors?.['required']"
              >Họ và tên là bắt buộc</span
            >
            <span *ngIf="name?.errors?.['minlength']"
              >Họ và tên phải có ít nhất 2 ký tự</span
            >
          </div>
        </div>
      </div>

      <!-- Contact Information Section -->
      <div class="form-section">
        <h3 class="section-title">Thông tin liên hệ</h3>

        <!-- Phone Number -->
        <div class="form-group">
          <label for="phoneNumber">
            <i class="bi bi-telephone"></i>
            Số điện thoại <span class="required">*</span>
          </label>
          <input
            type="tel"
            id="phoneNumber"
            formControlName="phoneNumber"
            placeholder="Nhập số điện thoại (10-11 chữ số)"
            [disabled]="isLoading"
            [class.is-invalid]="phoneNumber?.invalid && phoneNumber?.touched"
            [class.is-valid]="phoneNumber?.valid && phoneNumber?.touched"
          />
          <div
            class="validation-message"
            *ngIf="phoneNumber?.invalid && phoneNumber?.touched"
          >
            <span *ngIf="phoneNumber?.errors?.['required']"
              >Số điện thoại là bắt buộc</span
            >
            <span *ngIf="phoneNumber?.errors?.['pattern']"
              >Số điện thoại phải có 10-11 chữ số</span
            >
          </div>
        </div>

        <!-- Address -->
        <div class="form-group">
          <label for="address">
            <i class="bi bi-geo-alt"></i>
            Địa chỉ <span class="required">*</span>
          </label>
          <textarea
            id="address"
            formControlName="address"
            rows="3"
            placeholder="Nhập địa chỉ chi tiết"
            [disabled]="isLoading"
            [class.is-invalid]="address?.invalid && address?.touched"
            [class.is-valid]="address?.valid && address?.touched"
          ></textarea>
          <div
            class="validation-message"
            *ngIf="address?.invalid && address?.touched"
          >
            <span *ngIf="address?.errors?.['required']"
              >Địa chỉ là bắt buộc</span
            >
            <span *ngIf="address?.errors?.['minlength']"
              >Địa chỉ phải có ít nhất 10 ký tự</span
            >
          </div>
        </div>
      </div>

      <!-- Form Actions -->
      <div class="form-actions">
        <button
          type="button"
          class="btn btn-secondary"
          (click)="resetForm()"
          [disabled]="isLoading"
        >
          <i class="bi bi-arrow-clockwise"></i>
          Làm mới
        </button>
        <button
          type="submit"
          class="btn btn-primary"
          [disabled]="isLoading || registerForm.invalid"
        >
          <span
            *ngIf="isLoading"
            class="spinner-border spinner-border-sm"
          ></span>
          <i *ngIf="!isLoading" class="bi bi-person-plus"></i>
          Đăng ký
        </button>
      </div>

      <!-- Login Link -->
      <div class="login-link-container">
        <p>
          Đã có tài khoản?
          <button [routerLink]="['/user/login']" class="login-link">
            Đăng nhập ngay
          </button>
        </p>
      </div>
    </form>
  </div>
</div>
